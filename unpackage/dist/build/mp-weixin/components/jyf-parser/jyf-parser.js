(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/jyf-parser/jyf-parser"],{"224e":function(t,e,i){"use strict";var n=i("c98f"),s=i.n(n);s.a},"42f9":function(t,e,i){"use strict";i.r(e);var n=i("4f53"),s=i("92b6");for(var o in s)"default"!==o&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("224e");var a,r=i("f0c5"),h=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],a);e["default"]=h.exports},"4f53":function(t,e,i){"use strict";var n,s=function(){var t=this,e=t.$createElement;t._self._c},o=[];i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return o})),i.d(e,"a",(function(){return n}))},"669a":function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,s=function(){i.e("components/jyf-parser/libs/trees").then(function(){return resolve(i("e4fc"))}.bind(null,i)).catch(i.oe)},o={},a=(i("86f0"),t.getFileSystemManager?t.getFileSystemManager():null),r=i("f069");function h(t){for(var e=t.length,i=5381;e--;)i+=(i<<5)+t.charCodeAt(e);return i}var c=i("4a75"),l={name:"parser",data:function(){return{scaleAnimation:"",showAnimation:"",nodes:[],imgs:[]}},components:{trees:s},props:{html:null,autopause:{type:Boolean,default:!0},autosetTitle:{type:Boolean,default:!0},domain:String,gestureZoom:Boolean,lazyLoad:Boolean,selectable:Boolean,tagStyle:Object,showWithAnimation:Boolean,useAnchor:Boolean,useCache:Boolean},watch:{html:function(t){this.setContent(t,!0)}},mounted:function(){this.imgList=[],this.imgList.each=function(t){for(var e=0;e<this.length;e++){var i=t(this[e],e,this);i&&this.setItem(e,i)}},this.imgList.setItem=function(t,e){var i=this;if(e){if(e.includes("http")&&this.includes(e)){for(var n,s="",o=0;n=e[o];o++)if(s+=Math.random()>.5?n.toUpperCase():n,"/"==n&&"/"!=e[o-1]&&"/"!=e[o+1])break;return s+=e.substring(o+1),this[t]=s}if(this[t]=e,e.includes("data:image")){var r=e.match(/data:image\/(\S+?);(\S+?),(.+)/);if(!r)return;var h="".concat(wx.env.USER_DATA_PATH,"/").concat(Date.now(),".").concat(r[1]);a&&a.writeFile({filePath:h,data:r[3],encoding:r[2],success:function(e){return i[t]=h}})}}},this.nodes.length||this.setContent(this.html,!0)},beforeDestroy:function(){this.imgList.each((function(e){e&&e.includes(t.env.USER_DATA_PATH)&&a&&a.unlink({filePath:e})})),clearInterval(this.interval)},methods:{setContent:function(e,i){var s,a=this;if(!e)return this.nodes=[];if("string"==typeof e){var l=new r(e,this);if(this.useCache){var u=h(e);o[u]?this.nodes=o[u]:(this.nodes=l.parse(),o[u]=this.nodes)}else this.nodes=l.parse();this.$emit("parse",this.nodes)}else if("[object Array]"==Object.prototype.toString.call(e)){if(e.length&&"Parser"!=e[0].PoweredBy){l=new r(e,this);(function t(e){for(var i,n=0;i=e[n];n++)if("text"!=i.type){for(var s in i.attrs=i.attrs||{},i.attrs)c.trustAttrs[s]?"string"!=typeof i.attrs[s]&&(i.attrs[s]=i.attrs[s].toString()):i.attrs[s]=void 0;c.LabelHandler(i,l),c.ignoreTags[i.name]?e.splice(n--,1):i.children&&i.children.length?(l._STACK.push(i),t(i.children),l.popNode(l._STACK.pop())):i.children=void 0}})(e)}this.nodes=e}else{if("object"!=typeof e||!e.nodes)return console.warn("错误的 html 类型："+typeof e);this.nodes=e.nodes,console.warn("错误的 html 类型：object 类型已废弃")}n&&(this.document=new n(this.nodes,"nodes",this)),this.$nextTick((function(){a.imgList.length=0,a.videoContexts=[];var e=function e(i){for(var n=function(){var n=i[s];if("trees"==n.$options.name)for(o=!1,r=n.nodes.length;h=n.nodes[--r];)h.c||("img"==h.name?(h.attrs.i&&a.imgList.setItem(h.attrs.i,h.attrs.src),o||"0"==h.attrs.i||(o=!0,a.lazyLoad&&t.createIntersectionObserver?(n._observer&&n._observer.disconnect(),n._observer=t.createIntersectionObserver(n),n._observer.relativeToViewport({top:900,bottom:900}).observe("._img",(function(t){n.imgLoad=!0,n._observer&&(n._observer.disconnect(),n._observer=null)}))):n.imgLoad=!0)):"video"==h.name?(c=t.createVideoContext(h.attrs.id,n),c.id=h.attrs.id,a.videoContexts.unshift(c)):"audio"==h.name&&h.attrs.autoplay?wx.createAudioContext(h.attrs.id,n).play():"title"==h.name&&a.autosetTitle&&"text"==h.children[0].type&&t.setNavigationBarTitle({title:h.children[0].text}));n.$children.length&&e(n.$children)},s=i.length;s--;){var o,r,h,c;n()}};e(a.$children)})),this.interval=setInterval((function(){a.createSelectorQuery().select("._top").boundingClientRect().exec((function(t){a.width=t[0].width,t[0].height==s&&(a.$emit("ready",t[0]),clearInterval(a.interval)),s=t[0].height}))}),350),this.showWithAnimation&&(this.showAnimation="animation:show .5s")},getText:function(){for(var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.html||this.nodes,i="",n=0;t=e[n++];)if("text"==t.type)i+=t.text.replace(/&nbsp;/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");else if("br"==t.type)i+="\n";else{var s="p"==t.name||"div"==t.name||"tr"==t.name||"li"==t.name||"h"==t.name[0]&&t.name[1]>"0"&&t.name[1]<"7";s&&i&&"\n"!=i[i.length-1]&&(i+="\n"),t.children&&(i+=this.getText(t.children)),s&&"\n"!=i[i.length-1]?i+="\n":"td"!=t.name&&"th"!=t.name||(i+="\t")}return i},navigateTo:function(e){var i=this;if(!this.useAnchor)return e.fail&&e.fail({errMsg:"Anchor is disabled"});var n=function(n,s){t.createSelectorQuery().in(s||i).select(n).boundingClientRect().selectViewport().scrollOffset().exec((function(i){if(!i||!i[0])return e.fail&&e.fail({errMsg:"Label not found"});e.scrollTop=i[1].scrollTop+i[0].top,t.pageScrollTo(e)}))};e.id?n("._top >>> #"+e.id+", ._top >>> ."+e.id):n("._top")},getVideoContext:function(t){if(!t)return this.videoContexts;for(var e=this.videoContexts.length;e--;)if(this.videoContexts[e].id==t)return this.videoContexts[e];return null},preLoad:function(t,e){if("string"==typeof t){var i=h(t);t=new r(t,this).parse(),o[i]=t}var n=[];(function t(e){for(var i,s=0;i=e[s++];)"img"==i.name&&i.attrs.src&&!n.includes(i.attrs.src)&&n.push(i.attrs.src),t(i.children||[])})(t),e&&(n=n.slice(0,e)),this.wait=(this.wait||[]).concat(n),this.imgs?this.imgs.length<15&&(this.imgs=this.imgs.concat(this.wait.splice(0,15-this.imgs.length))):this.imgs=this.wait.splice(0,15)},_load:function(t){this.wait.length&&this.$set(this.imgs,t.target.id,this.wait.shift())},_tap:function(e){if(this.gestureZoom&&e.timeStamp-this.lastTime<300){if(this.zoomIn)this.animation.translateX(0).scale(1).step(),t.pageScrollTo({scrollTop:(e.touches[0].pageY-e.currentTarget.offsetTop+this.initY)/2-e.touches[0].clientY,duration:400});else{var i=e.touches[0].pageX-e.currentTarget.offsetLeft;this.initY=e.touches[0].pageY-e.currentTarget.offsetTop,this.animation=t.createAnimation({transformOrigin:"".concat(i,"px ").concat(this.initY,"px 0"),timingFunction:"ease-in-out"}),this.animation.scale(2).step(),this.tMax=i/2,this.tMin=(i-this.width)/2,this.tX=0}this.zoomIn=!this.zoomIn,this.scaleAnimation=this.animation.export()}this.lastTime=e.timeStamp},_touchstart:function(t){1==t.touches.length&&(this.initX=this.lastX=t.touches[0].pageX)},_touchmove:function(t){var e=t.touches[0].pageX-this.lastX;if(this.zoomIn&&1==t.touches.length&&Math.abs(e)>20){if(this.lastX=t.touches[0].pageX,this.tX<=this.tMin&&e<0||this.tX>=this.tMax&&e>0)return;this.tX+=e*Math.abs(this.lastX-this.initX)*.05,this.tX<this.tMin&&(this.tX=this.tMin),this.tX>this.tMax&&(this.tX=this.tMax),this.animation.translateX(this.tX).step(),this.scaleAnimation=this.animation.export()}}}};e.default=l}).call(this,i("543d")["default"])},"92b6":function(t,e,i){"use strict";i.r(e);var n=i("669a"),s=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,(function(){return n[t]}))}(o);e["default"]=s.a},c98f:function(t,e,i){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/jyf-parser/jyf-parser-create-component',
    {
        'components/jyf-parser/jyf-parser-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("42f9"))
        })
    },
    [['components/jyf-parser/jyf-parser-create-component']]
]);
