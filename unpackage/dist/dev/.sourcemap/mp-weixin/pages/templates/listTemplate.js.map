{"version":3,"sources":["uni-app:///main.js","webpack:///D:/code/2.0app/pages/templates/listTemplate.vue?9937","webpack:///D:/code/2.0app/pages/templates/listTemplate.vue?a49e","webpack:///D:/code/2.0app/pages/templates/listTemplate.vue?b4d2","webpack:///D:/code/2.0app/pages/templates/listTemplate.vue?d659","uni-app:///pages/templates/listTemplate.vue"],"names":["createPage","Page","renderjs","component","options","__file","components","render","_vm","this","_h","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped"],"mappings":";;;;wEAAA,qBACA,sBACA,qD,mDACAA,EAAWC,a;;;;2DCHX,6OACIC,EADJ,mKAQIC,EAAY,qBACd,aACA,YACA,sBACA,EACA,KACA,KACA,MACA,EACA,gBACAD,GAGFC,EAAUC,QAAQC,OAAS,mCACZ,aAAAF,E;;;;2GCtBf,snC;;;;2GCAA,IAAIG,EAAJ,0LACA,IAAIC,EAAS,WACX,IAAIC,EAAMC,KACNC,EAAKF,EAAIG,eACJH,EAAII,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBR,EAAOS,eAAgB,G;;;;2DCRvB,uuBAAgrB,eAAG,G;;;;0ICqBnrB,sCAEA,GADA,oCACA,iBACA,2C,6qDAOA,gB,EACA,CACA,qEACA,KAFA,WAGA,OAEA,cACA,OACA,cACA,cACA,gBACA,UAEA,WACA,YACA,cACA,oDACA,uBAIA,eACA,sDADA,IAEA,0EAFA,CAGA,aAHA,WAIA,gBAGA,OACA,aADA,SACA,KACA,iCAGA,cACA,gEADA,IAEA,+CAFA,IAGA,0CAHA,IAIA,6CAJA,IAKA,wGALA,IAMA,yDANA,IAOA,iDAPA,CAQA,UARA,SAQA,GACA,0BACA,YACA,yBAEA,aAbA,SAaA,GACA,iCACA,6BAEA,6BAEA,YAnBA,SAmBA,GACA,oBACA,mCAEA,YAvBA,SAuBA,qBAEA,4BAGA,SALA,EAKA,iBALA,EAKA,oBALA,EAKA,iBACA,aAMA,+CAGA,OACA,kCACA,wCACA,8CAEA,qEACA,+BAEA,KAEA,KACA,0BACA,qBACA,mBACA,cACA,+BAIA,eACA,0BACA,kCACA,qCACA,uBACA,kCACA,mBAEA,cACA,WACA,wBACA,aAEA,mBACA,yBAEA,iBACA,wBACA,iDAEA,UACA,8BACA,iCACA,iCACA,mCAEA,4BACA,kBAGA,wBAEA,UACA,uDACA,eACA,QACA,+BACA,uCAEA,KAEA,iCAEA,wBACA,QACA,oBAGA,uBACA,QACA,2BA7EA,4GAiFA,OA/IA,SA+IA,GACA,uCACA,oBAGA,MACA,iCAGA,mCACA,mBACA,WAEA,iCACA,GACA,eACA,oBACA,oBACA,wBACA,sBACA,sCACA,aACA,yBACA,kBACA,UACA,sBACA,8BAEA,eACA,oCAEA,oBAEA,WACA,6BACA,wCAGA,kBArLA,WAsLA,qCAEA,cAxLA,WAyLA,0C","file":"pages/templates/listTemplate.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/templates/listTemplate.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./listTemplate.vue?vue&type=template&id=55c10f07&name=BRATemplate&\"\nvar renderjs\nimport script from \"./listTemplate.vue?vue&type=script&lang=js&\"\nexport * from \"./listTemplate.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/templates/listTemplate.vue\"\nexport default component.exports","export * from \"-!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./listTemplate.vue?vue&type=template&id=55c10f07&name=BRATemplate&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./listTemplate.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../360安全浏览器下载/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./listTemplate.vue?vue&type=script&lang=js&\"","<template name=\"BRATemplate\">\r\n\t<!-- 带选择按钮 -->\n\t<view class=\"BRATemplate\">\r\n\t\t<m-back-bar>  \r\n\t\t\t<block slot=\"barTitle\">{{barTitle}}</block>\r\n\t\t\t<block slot=\"barRight\">\r\n\t\t\t\t<top-btns-coms :tabInfo=\"tabInfo\" :btnBasicInfo=\"btnBasicInfo\"></top-btns-coms></top-btns-coms> \r\n\t\t\t</block>\r\n\t\t</m-back-bar>\r\n\t\t<view class=\"list-seach\" v-if=\"quickQuery.isSearch\">\r\n\t\t\t<m-input-search :tabInfo=\"tabInfo\" :mobileTabId=\"tabInfo.mobileTabId\" :isQuickQuery=\"quickQuery.isQuickQuery\" :isSeniorFilter=\"quickQuery.isSeniorFilter\"  @doSearch=\"handelSearch\"></m-input-search> \r\n\t\t</view>\r\n\t\t<ListCom ref=\"List\" v-if=\"isShow\" :tabInfo=\"tabInfo\" :listConfig = \"listConfig\" @clickList=\"clickList\"></ListCom>\r\n\t\t<view class=\"BRATemplate-btns\">\r\n\t\t\t<bottom-btns-coms :tabInfo=\"tabInfo\">\r\n\t\t\t</bottom-btns-coms> \r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script>\r\n\timport bus from '@/static/js/bus'\r\n\timport {homeApi} from '@/common/request/api.js'\r\n\timport { mapState, mapMutations } from 'vuex'\r\n\timport ClassList from '@/static/js/ClassList.js'\r\n\t\r\n\timport mInputSearch from '@/components/element/m-inputSearch.vue'\r\n\timport topBtnsComs from '@/pageComs/topBtnsComs.vue'\r\n\timport bottomBtnsComs from '@/pageComs/bottomBtnsComs.vue'\r\n\timport ListCom from '@/components/makeup/list/ListCom.vue'\r\n\t\r\n\tlet listTem = new ClassList(),mobileTabs = \"\"\r\n\texport default{\r\n\t\tcomponents: {topBtnsComs,bottomBtnsComs,mInputSearch,ListCom},\r\n\t\tdata (){\r\n\t\t\treturn {\r\n\t\t\t\t//列表属性\r\n\t\t\t\tlistConfig:{},\r\n\t\t\t\tpage:0,//总页数\r\n\t\t\t\tcurrentPage:1,//当前页码\r\n\t\t\t\tquickQuery:{},//便捷搜索\r\n\t\t\t\tsearchParams:{},//搜索参数\r\n\t\t\t\tisShow:false,\r\n\t\t\t\t//面板属性\r\n\t\t\t\ttabInfo:{},//面板基本信息\r\n\t\t\t\tbarTitle:'',//返回栏标题\r\n\t\t\t\tbtnBasicInfo:{\r\n\t\t\t\t\tnormalEvent:[\"normalBtn\",\"addBtn\",\"relationAddBtn\"],\r\n\t\t\t\t\tdelEvent:[\"delBtn\"]\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState([\"bundleName\",\"bundleId\",\"BusinessID\"]),\r\n\t\t\t...mapState(\"common\", [\"templateParams\",\"tabsElements\",\"tabsFormDatas\"]), //面板参数\r\n\t\t\ttemplateType(){\r\n\t\t\t\treturn \"list\"\r\n\t\t\t}\r\n\t\t},\r\n\t\twatch: {\r\n\t\t\tsearchParams(newValue, oldValue) {\r\n\t\t\t\tthis.$refs.list.searchParams = newValue\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t...mapMutations([\"SET_bundle\",\"SET_BusinessID\",\"SET_ORIGIN\"]),\r\n\t\t\t...mapMutations(\"list\",[\"SET_LIST_REFRESH\"]),\r\n\t\t\t...mapMutations(\"form\", [\"SET_ALLBTNS\"]),\r\n\t\t\t...mapMutations(\"home\",[\"SET_NEW_BUNDLE\"]),\r\n\t\t\t...mapMutations(\"common\",[\"SET_TEMPLATE_PARAMS\",\"SET_TRIGGERMAP\",\"SET_COMMONSLT\",\"SET_TABS_ELEMENT\"]),//设置面板变量\r\n\t\t\t...mapMutations(\"advanceFilter\", [\"SET_ADVAN_FILTERS\"]),\r\n\t\t\t...mapMutations(\"Toast\", [\"TOAST_REQUESTURLS\"]),\r\n\t\t\tclickList(params){//点击列表\r\n\t\t\t\tparams = {...this.tabInfo,...params}\r\n\t\t\t\tparams.isMain = false\r\n\t\t\t\tlistTem.clickListNode(this,params)\r\n\t\t\t},\r\n\t\t\thandelSearch(searchParam){//处理搜索\r\n\t\t\t\tlet params = {...this.quickQuery, ...searchParam}\r\n\t\t\t\tconst quickQueryParams = listTem.handleSearchText(this,params)\r\n\t\t\t\t\r\n\t\t\t\tthis.$refs.List.doSearch(quickQueryParams)\r\n\t\t\t},\r\n\t\t\tsetListInfo(params){//设置列表信息\r\n\t\t\t\tthis.page = params.page || 1\r\n\t\t\t\tthis.currentPage = params.currentPage || 1\r\n\t\t\t},\r\n\t\t\tsetPageInfo(mobileTabsBYRelation,mobileTabId,mobileTab){//根据relationTab取具体面板信息\r\n\t\t\t\tconst _this = this,\r\n\t\t\t\t\t mobileTabRelationTab = mobileTab[mobileTabsBYRelation.mobileTabRelationTabId] || {}\r\n\t\t\t\t\r\n\t\t\t\t//如果数据来源是接口\r\n\t\t\t\tconst {dataSourceType, commonApiHeaderId, interfaceInParam} = mobileTabsBYRelation || {}\r\n\t\t\t\tif(dataSourceType === 2 && !commonApiHeaderId){//如果数据来源是接口，但没有接口id提示错误\r\n\t\t\t\t\tthis.Static_GlobalFucs.showModal(this, {content:this.$i18nMsg(\"lang-configuration-noInterface\")},'error')\r\n\t\t\t\t\treturn \r\n\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t//设置返回栏标题\r\n\t\t\t\tthis.barTitle = mobileTabsBYRelation.mobileTabName || this.bundleName\r\n\t\t\t\t\r\n\t\t\t\t//设置列表参数\r\n\t\t\t\tlet queryParamsConfig = {\r\n\t\t\t\t\tadvancedQuery:mobileTabsBYRelation.advancedQuery || {},//过滤条件中需要转化的变量\r\n\t\t\t\t\tadvancedSqlQuery:mobileTabsBYRelation.advancedSqlQuery || [],//sql中的变量\r\n\t\t\t\t\trelationMainTab:this.tabInfo.relationMainTab,\r\n\t\t\t\t}\r\n\t\t\t\tif(this.tabInfo.jumpTag) queryParamsConfig.bundleParams = this.tabInfo.bundleParams || {}\r\n\t\t\t\tconst queryParams = listTem.advancedParams(this,queryParamsConfig)//获取过滤条件中的变量\r\n\r\n\t\t\t\tlet listConfig = {}\r\n\t\t\t\t//关联面板，自动与主业务id关联\r\n\t\t\t\tlet params = {}\r\n\t\t\t\tif(mobileTabsBYRelation.mobileTabShowType === 4){//如果为面板展示类型\r\n\t\t\t\t\tparams[mobileTabsBYRelation.relationColumn] = {\r\n\t\t\t\t\t\tstatic_connector: 3,\r\n\t\t\t\t\t\tstatic_type: 2,\r\n\t\t\t\t\t\tstatic_value: this.BusinessID\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlistConfig.otherParams = {//列表额外参数，过滤条件中设置的参数\r\n\t\t\t\t\tglobalMap:queryParams.advancedQuery,\r\n\t\t\t\t\tglobalQueryMap:queryParams.advancedSqlQuery,\r\n\t\t\t\t\tmobileTabId:this.tabInfo.mobileTabId,\r\n\t\t\t\t\telementList:mobileTabsBYRelation.elements,\r\n\t\t\t\t\tmobileTabSource:mobileTabsBYRelation.mobileTabSource,\r\n\t\t\t\t\tseniorFilterMap:params\r\n\t\t\t\t}\r\n\t\t\t\tlistConfig.baseParams = {//列表基本参数\r\n\t\t\t\t\thasIcon:true,\r\n\t\t\t\t\tlistIcon:mobileTabsBYRelation.listIcon || {},\r\n\t\t\t\t\tmultiple:true,\r\n\t\t\t\t}\r\n\t\t\t\tlistConfig.isCheckedParams = {//列表点击返回参数\r\n\t\t\t\t\tprimaryKey:mobileTabsBYRelation.primaryKey\r\n\t\t\t\t}\r\n\t\t\t\tlistConfig.goEventParams = {//列表点击返回参数\r\n\t\t\t\t\tprimaryKey:mobileTabsBYRelation.primaryKey,\r\n\t\t\t\t\tmobileTabRelationTabId:mobileTabsBYRelation.mobileTabRelationTabId,\r\n\t\t\t\t}\r\n\t\t\t\tif(dataSourceType === 2 && commonApiHeaderId){\r\n\t\t\t\t\tlistConfig.baseParams.dataSourceType = dataSourceType\r\n\t\t\t\t\tlistConfig.baseParams.commonApiHeaderId = commonApiHeaderId\r\n\t\t\t\t\tlistConfig.otherParams.interfaceInParam = interfaceInParam\r\n\t\t\t\t\tlistConfig.url = \"static_getDataByInterface\" //来源与接口\r\n\t\t\t\t} \r\n\t\t\t\telse listConfig.url = \"currencyGetListData\"\r\n\t\t\t\tthis.listConfig = listConfig\r\n\t\t\t\t\r\n\t\t\t\t//延迟显示列表\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t//如果数据来源为接口时接口id必须不能为空；或者面板数据源和控件列表不能为空\r\n\t\t\t\t\tif((dataSourceType === 2 && commonApiHeaderId)\r\n\t\t\t\t\t\t|| (mobileTabsBYRelation.mobileTabSource && mobileTabsBYRelation.elements.length>0))  this.isShow = true\r\n\t\t\t\t\tthis.SET_ALLBTNS({//设置按钮\r\n\t\t\t\t\t\ttabId:mobileTabId,\r\n\t\t\t\t\t\tbottomBtns:mobileTabsBYRelation.btnList.bottomBtn,\r\n\t\t\t\t\t\ttopRightBtns:mobileTabsBYRelation.btnList.topRightBtn\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 100)\r\n\t\t\t\t//设置搜索控件参数\r\n\t\t\t\tthis.quickQuery = mobileTabsBYRelation.quickQuery || {}\r\n\t\t\t\t\r\n\t\t\t\tthis.SET_ADVAN_FILTERS({//设置高级筛选控件\r\n\t\t\t\t\ttabId:mobileTabId,\r\n\t\t\t\t\tparams:mobileTabsBYRelation.elements\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t\tthis.SET_TABS_ELEMENT({//设置面板控件\r\n\t\t\t\t\ttabId:mobileTabId,\r\n\t\t\t\t\telements:mobileTabsBYRelation.elements\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t},\r\n\t\tonLoad(options){\r\n\t\t\tthis.TOAST_REQUESTURLS({type:\"clear\"})//清空请求地址\r\n\t\t\tconst currentTabId = options.relationTab //当前面板的id\r\n\t\t\t\r\n\t\t\t//当前面板id不存在，不进行面板布局 todo 进入报错界面\r\n\t\t\tif(!currentTabId) return \r\n\t\t\tconst currentTemParams = this.templateParams[currentTabId] || {} //获取当前面板参数\r\n\t\t\t\r\n\t\t\t//判断是否有mobileTabs\r\n\t\t\tconst bundleInfo = uni.getStorageSync(currentTemParams.bundleId) || {}\r\n\t\t\tconst mobileTabs = bundleInfo.mobileTabs || {},\r\n\t\t\t\t  mobileTabsBYRelation = mobileTabs[currentTabId] || {}\r\n\t\t\t//定义面板信息\r\n\t\t\tlet onKey = `listReload${this._uid}`\r\n\t\t\tlet tabInfo = {\r\n\t\t\t\t_uid:this._uid,\r\n\t\t\t\ttemplateType:\"list\",\r\n\t\t\t\tbundleId:currentTemParams.bundleId,\r\n\t\t\t\tbundleName:currentTemParams.bundleName,\r\n\t\t\t\tmobileTabId:Number(currentTabId),\r\n\t\t\t\trelationMainTab:currentTemParams.relationMainTab || '',\r\n\t\t\t\tmobileTabs:mobileTabs,\r\n\t\t\t\ttrigger:bundleInfo.triggerMap || {},\r\n\t\t\t\tonKey:currentTemParams.onKey || '',\r\n\t\t\t\tselfKey:onKey,\r\n\t\t\t\telement:currentTemParams.element || {},\r\n\t\t\t\tmainnColumn:mobileTabsBYRelation.relationColumn,//关联面板上的关联主业务字段，用于关联新增按钮\r\n\t\t\t}\r\n\t\t\tthis.tabInfo = tabInfo\r\n\t\t\tthis.setPageInfo(mobileTabsBYRelation,tabInfo.mobileTabId,mobileTabs)\r\n\t\t\t\r\n\t\t\tthis.SET_ORIGIN(true)//设置按钮栏显示\r\n\t\t\t//设置监听\r\n\t\t\tconst _this = this\r\n\t\t\tbus.$on(onKey, (params) => { //reload\r\n\t\t\t\t_this.$refs.List.getListData(\"reload\"); \r\n\t\t\t})\r\n\t\t},\r\n\t\tonPullDownRefresh() {//重新加载\r\n\t\t\tthis.$refs.List.getListData(\"load\");\r\n\t\t},\r\n\t\tonReachBottom(){// 上拉加载\r\n\t\t\tthis.$refs.List.getListData(\"loadnext\");\r\n\t\t},\r\n\t}\n</script>\n"],"sourceRoot":""}